# 3.7.5需求

#### 运营平台 
* 1 添加限时抢购起订量  -- 4h  
    * 1功能描述：限时抢购功能中没有限制用户的起订量.(最小购买数量) 需要添加  
    * 2技术概要：   
       * 1 在限时抢购表中添加一个字段来存储起订量
       * 2 修改限时抢购用户的下单接口..判断用户购买的数量是否满足起订量

* 2 搭配   -- 1h
    * 1 功能描述：目前商品搭配只能搭配自己店铺的的商品 需要删除此限制
    * 2 技术概要：在添加搭配的接口中删除此限制
    
* 3 刷销量
    * 1 功能描述：定时的给某些商品添加销量..
    * 2 技术概要：
       * 1 添加一张刷单策略主表     -- 2h 
       * 2 添加一张刷单明细表 (存储每个商品当前的销量增加情况及记录上一次添加了多少) -- 2h 
       * 3 添加一张商品统计表 ( 主要是商品表可能频繁的要被操作 统计信息独立开来 减少锁竞争 增加用户的体验) -- 1h  
       * 4 添加一张异常表 ( 刷单为成功的记录 ) -- 1h 
       * 4 策略的增删改查   -- 8h 
       * 5 在增加策略的时候计算每天需要循环几次存在主表中.. 然后给定时项目发送定时任务 -- 2h 
       * 6 定时任务第一次执行的时候初始化刷单明细表...固化每个商品.要总的刷多少量.. 平均值是多少..上一次是刷量是多少.. -- 4h 
       * 7 刷单的接口..销量表中对应商品添加销量.. 记录日志 记录异常..  -- 4h 
       * 8 自测  -- 8h
      

#### 供应商平台
 * 1 供应商商品定时上架  -- 6h
    * 1.1 功能描述：供应商在提审商品的时候控制商品的上架策略：审核通过后直接上架,定时上架（用户输入时间）,不上架
    * 1.2 技术概要：
       * 1 商品表添加2个字段来存储上架策略 put_on_type  auto_put_on_time 
       * 2 修改添加编辑商品接口加入两个字段存储的时候需要设值（mvc方法罗列属性方式的弊端）
       * 4 审核后上架  ： 老运营平台添加审核通过后直接上架 逻辑
       * 5 添加定时项目  
       * 6 定时上架    :  审核过通过后调用定时项目接口 添加job
       * 7 定时项目调用任务项目的接口
       
 * 2 定时修改商品sku库存  -- 16h
    * 1.1 功能描述: 供应商创建商品时设置定时修改库存时间, 商品到指定时间自动更新库存量
    * 1.2 技术概要:
       * 1 sku表添加字段:
            auto_set_remain_count_time 上架后N天 或者 指定日期时间戳
            auto_set_type 0关闭,1指定日期 ,2上架后N天
            auto_set_count
       * 2 新建商品sku时设置值, 添加定时任务1
       * 3 商品上架时, 添加定时任务2
       * 4 提供修改sku库存回调接口 
       * 5 修改定时上架, 删除未执行job, 新增新job
             
        
 #### store api 后台
 * 1 搜索订单接口 -- 6h
   * 1 功能描述：用户在app中可以通过多个条件来范围或者精确的筛选出自己想要的查看的订单
   * 2 技术概要：  
      * 1 添加一个接口 此接口返回的数据与订单列表返回的数据是一样的 此接口主要功能在于sql及数据返回封装
      * 2 sql 查询订单明细作为主查询 orderItem  
        左关联订单表 order on orderItem.orderNo = order.orderNo 
        左关联商品表 product on product.id = orderItem.productId 
        左关联品牌表 brand on brand.brandId = product.brandId 
      * 3 封装返回字段 参考订单列表字段
       
  
3.7.8 会员
会员有两条途径
    1.老系统开通会员,开通会员,如果有了,就不处理. 没有就创建一条会员信息
                  关闭会员,将会员关闭,有效期不处理
                  关闭会员后再开通,将会员开通,有效期不处理
    2.app端购买
        如果没有会员,创建一条会员信息
        如果有会员:如果会员有效期没到:有效期+1年时间戳
                :如果会员有效期到了:有效期当前时间+1年时间戳
    3.数据库刷会员信息,拥有小程序的用户,插入一条会员信息
    